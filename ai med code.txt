<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MedLeaf ‚Äì AI Health Assistant</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --sage: #4a7c59;
    --sage-light: #6fa382;
    --sage-pale: #e8f0eb;
    --cream: #faf7f2;
    --bark: #2c1f14;
    --bark-light: #5c4a3a;
    --terracotta: #c4714a;
    --gold: #d4a847;
    --white: #ffffff;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--cream);
    color: var(--bark);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    position: relative;
    overflow-x: hidden;
  }
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: 
      radial-gradient(ellipse 80% 60% at 10% 10%, rgba(74,124,89,0.08) 0%, transparent 60%),
      radial-gradient(ellipse 60% 80% at 90% 90%, rgba(196,113,74,0.06) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }
  .leaf-bg {
    position: fixed;
    opacity: 0.04;
    pointer-events: none;
    z-index: 0;
    font-size: 200px;
  }
  .leaf-bg.tl { top: -40px; left: -40px; transform: rotate(-20deg); }
  .leaf-bg.br { bottom: -40px; right: -40px; transform: rotate(160deg); }
  header {
    position: relative;
    z-index: 10;
    padding: 24px 40px;
    display: flex;
    align-items: center;
    gap: 14px;
    border-bottom: 1px solid rgba(74,124,89,0.15);
    background: rgba(250,247,242,0.9);
    backdrop-filter: blur(10px);
  }
  .logo-icon {
    width: 44px;
    height: 44px;
    background: linear-gradient(135deg, var(--sage), var(--sage-light));
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    box-shadow: 0 4px 12px rgba(74,124,89,0.3);
  }
  .logo-text h1 {
    font-family: 'Playfair Display', serif;
    font-size: 22px;
    color: var(--bark);
    letter-spacing: -0.3px;
  }
  .logo-text span {
    font-size: 11px;
    color: var(--sage);
    letter-spacing: 1.5px;
    text-transform: uppercase;
    font-weight: 500;
  }
  .disclaimer-pill {
    margin-left: auto;
    background: rgba(196,113,74,0.1);
    border: 1px solid rgba(196,113,74,0.3);
    color: var(--terracotta);
    font-size: 11px;
    padding: 6px 14px;
    border-radius: 100px;
    font-weight: 500;
    letter-spacing: 0.3px;
  }
  main {
    flex: 1;
    display: flex;
    flex-direction: column;
    max-width: 860px;
    width: 100%;
    margin: 0 auto;
    padding: 32px 24px 120px;
    position: relative;
    z-index: 1;
  }
  .hero {
    text-align: center;
    padding: 48px 0 40px;
    animation: fadeUp 0.7s ease both;
  }
  .hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: var(--sage-pale);
    border: 1px solid rgba(74,124,89,0.2);
    padding: 6px 16px;
    border-radius: 100px;
    font-size: 12px;
    color: var(--sage);
    font-weight: 500;
    margin-bottom: 20px;
    letter-spacing: 0.5px;
  }
  .hero h2 {
    font-family: 'Playfair Display', serif;
    font-size: clamp(28px, 5vw, 42px);
    line-height: 1.2;
    color: var(--bark);
    margin-bottom: 14px;
  }
  .hero h2 em { color: var(--sage); font-style: italic; }
  .hero p {
    color: var(--bark-light);
    font-size: 15px;
    max-width: 480px;
    margin: 0 auto;
    line-height: 1.7;
  }
  .quick-symptoms {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
    margin: 24px 0 32px;
    animation: fadeUp 0.7s 0.1s ease both;
  }
  .chip {
    padding: 8px 18px;
    background: white;
    border: 1.5px solid rgba(74,124,89,0.2);
    border-radius: 100px;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s;
    color: var(--bark-light);
    font-weight: 400;
    box-shadow: 0 2px 6px rgba(0,0,0,0.04);
  }
  .chip:hover {
    background: var(--sage);
    border-color: var(--sage);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(74,124,89,0.25);
  }
  .chat-container {
    display: flex;
    flex-direction: column;
    gap: 20px;
    animation: fadeUp 0.7s 0.15s ease both;
  }
  .message {
    display: flex;
    gap: 14px;
    align-items: flex-start;
    animation: fadeUp 0.4s ease both;
  }
  .message.user { flex-direction: row-reverse; }
  .avatar {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    flex-shrink: 0;
  }
  .avatar.ai {
    background: linear-gradient(135deg, var(--sage), var(--sage-light));
    box-shadow: 0 3px 10px rgba(74,124,89,0.3);
  }
  .avatar.user {
    background: linear-gradient(135deg, var(--terracotta), #d4856a);
    box-shadow: 0 3px 10px rgba(196,113,74,0.3);
  }
  .bubble {
    max-width: 78%;
    padding: 16px 20px;
    border-radius: 18px;
    font-size: 14.5px;
    line-height: 1.65;
  }
  .message.ai .bubble {
    background: white;
    border: 1px solid rgba(74,124,89,0.12);
    border-top-left-radius: 4px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.05);
    color: var(--bark);
  }
  .message.user .bubble {
    background: linear-gradient(135deg, var(--sage), var(--sage-light));
    color: white;
    border-top-right-radius: 4px;
  }
  .bubble h3 {
    font-family: 'Playfair Display', serif;
    font-size: 16px;
    color: var(--sage);
    margin: 12px 0 6px;
  }
  .bubble h3:first-child { margin-top: 0; }
  .bubble .section-block {
    background: var(--sage-pale);
    border-left: 3px solid var(--sage);
    padding: 10px 14px;
    border-radius: 0 8px 8px 0;
    margin: 10px 0;
    font-size: 13.5px;
  }
  .bubble .warning-box {
    background: rgba(196,113,74,0.08);
    border: 1px solid rgba(196,113,74,0.2);
    border-radius: 8px;
    padding: 10px 14px;
    margin-top: 12px;
    font-size: 12.5px;
    color: var(--terracotta);
    display: flex;
    gap: 8px;
    align-items: flex-start;
  }
  .typing-indicator {
    display: flex;
    gap: 5px;
    padding: 14px 18px;
    background: white;
    border: 1px solid rgba(74,124,89,0.12);
    border-radius: 18px;
    border-top-left-radius: 4px;
    width: fit-content;
    box-shadow: 0 4px 20px rgba(0,0,0,0.05);
  }
  .typing-dot {
    width: 7px;
    height: 7px;
    background: var(--sage-light);
    border-radius: 50%;
    animation: bounce 1.2s ease infinite;
  }
  .typing-dot:nth-child(2) { animation-delay: 0.2s; }
  .typing-dot:nth-child(3) { animation-delay: 0.4s; }
  @keyframes bounce {
    0%, 60%, 100% { transform: translateY(0); }
    30% { transform: translateY(-6px); }
  }
  .input-area {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background: rgba(250,247,242,0.95);
    backdrop-filter: blur(20px);
    border-top: 1px solid rgba(74,124,89,0.12);
    padding: 16px 24px 20px;
  }
  .input-wrapper {
    max-width: 860px;
    margin: 0 auto;
    display: flex;
    gap: 12px;
    align-items: flex-end;
  }
  .input-box {
    flex: 1;
    background: white;
    border: 1.5px solid rgba(74,124,89,0.2);
    border-radius: 16px;
    padding: 14px 18px;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    color: var(--bark);
    resize: none;
    outline: none;
    transition: border-color 0.2s;
    max-height: 120px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.04);
    line-height: 1.5;
  }
  .input-box:focus {
    border-color: var(--sage);
    box-shadow: 0 0 0 3px rgba(74,124,89,0.08), 0 2px 12px rgba(0,0,0,0.04);
  }
  .input-box::placeholder { color: #aaa; }
  .send-btn {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, var(--sage), var(--sage-light));
    border: none;
    border-radius: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    transition: all 0.2s;
    box-shadow: 0 4px 14px rgba(74,124,89,0.35);
    flex-shrink: 0;
  }
  .send-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(74,124,89,0.45);
  }
  .send-btn:active { transform: translateY(0); }
  .send-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .hidden { display: none; }
  ::-webkit-scrollbar { width: 5px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: rgba(74,124,89,0.2); border-radius: 10px; }
</style>
</head>
<body>

<div class="leaf-bg tl">üåø</div>
<div class="leaf-bg br">üåø</div>

<header>
  <div class="logo-icon">üåø</div>
  <div class="logo-text">
    <h1>MedLeaf</h1>
    <span>AI Health Assistant</span>
  </div>
  <div class="disclaimer-pill">‚ö†Ô∏è Not a substitute for professional medical advice</div>
</header>

<main>
  <div class="hero" id="hero">
    <div class="hero-badge">ü§ñ Powered by AI ¬∑ üåø Natural Remedies ¬∑ üíä Medicine Guidance</div>
    <h2>Your personal<br><em>health companion</em></h2>
    <p>Describe your symptoms and get personalized home remedies and over-the-counter medicine suggestions. Covers cold, cough, fever, headache, and more.</p>
  </div>

  <div class="quick-symptoms" id="quickSymptoms">
    <div class="chip" onclick="askSymptom('I have a cold with runny nose and sneezing')">ü§ß Cold</div>
    <div class="chip" onclick="askSymptom('I have a persistent dry cough')">üòÆ‚Äçüí® Cough</div>
    <div class="chip" onclick="askSymptom('I have a high fever of 101¬∞F')">üå°Ô∏è Fever</div>
    <div class="chip" onclick="askSymptom('I have a severe headache')">ü§ï Headache</div>
    <div class="chip" onclick="askSymptom('I have a sore throat with difficulty swallowing')">üò´ Sore Throat</div>
    <div class="chip" onclick="askSymptom('I have an upset stomach and indigestion')">ü´É Indigestion</div>
    <div class="chip" onclick="askSymptom('I feel nauseous and want to vomit')">ü§¢ Nausea</div>
    <div class="chip" onclick="askSymptom('I have body aches and fatigue')">üò¥ Body Ache</div>
    <div class="chip" onclick="askSymptom('I have skin rash and itching')">üî¥ Skin Rash</div>
    <div class="chip" onclick="askSymptom('I have constipation for 3 days')">üíä Constipation</div>
    <div class="chip" onclick="askSymptom('I have diarrhea and loose stools')">üè• Diarrhea</div>
    <div class="chip" onclick="askSymptom('I have acidity and heartburn')">üî• Acidity</div>
  </div>

  <div class="chat-container" id="chatContainer"></div>
</main>

<div class="input-area">
  <div class="input-wrapper">
    <textarea class="input-box" id="userInput" placeholder="Describe your symptoms‚Ä¶ (e.g. I have a cold with runny nose and mild fever)" rows="1"></textarea>
    <button class="send-btn" id="sendBtn" onclick="sendMessage()">‚û§</button>
  </div>
</div>

<script>
// ‚ö†Ô∏è REPLACE THIS URL WITH YOUR CLOUDFLARE WORKER URL
const WORKER_URL = 'https://medleaf.jeeva-54281.workers.dev';

const SYSTEM_PROMPT = `You are MedLeaf, a knowledgeable AI Health Assistant specializing in common illnesses and natural remedies. 

When a user describes symptoms, you must:
1. Identify the likely condition based on symptoms
2. Provide Home/Natural Remedies using common household ingredients (honey, ginger, turmeric, lemon, etc.)
3. Suggest Over-the-Counter Medicines (paracetamol, antihistamines, antacids etc.)
4. Give Lifestyle Tips - rest, hydration, diet advice
5. Red Flag Warning - when they should see a real doctor

Format your response using:
- Brief empathetic acknowledgment
- üè† Home Remedies section
- üíä OTC Medicines section  
- üåø Lifestyle Tips section
- ‚ö†Ô∏è See a Doctor If... section

Always remind users this is general guidance and not a substitute for professional medical advice.`;

let conversationHistory = [];
let isLoading = false;

const input = document.getElementById('userInput');
input.addEventListener('input', () => {
  input.style.height = 'auto';
  input.style.height = Math.min(input.scrollHeight, 120) + 'px';
});
input.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
});

function askSymptom(symptom) {
  input.value = symptom;
  sendMessage();
}

function hideHero() {
  const hero = document.getElementById('hero');
  const chips = document.getElementById('quickSymptoms');
  if (!hero.classList.contains('hidden')) {
    hero.style.opacity = '0';
    chips.style.opacity = '0';
    setTimeout(() => {
      hero.classList.add('hidden');
      chips.classList.add('hidden');
    }, 300);
  }
}

function createMessage(role, content) {
  const container = document.getElementById('chatContainer');
  const msgDiv = document.createElement('div');
  msgDiv.className = `message ${role}`;
  const avatar = document.createElement('div');
  avatar.className = `avatar ${role}`;
  avatar.textContent = role === 'ai' ? 'üåø' : 'üë§';
  const bubble = document.createElement('div');
  bubble.className = 'bubble';
  bubble.innerHTML = role === 'ai' ? formatResponse(content) : content;
  msgDiv.appendChild(avatar);
  msgDiv.appendChild(bubble);
  container.appendChild(msgDiv);
  msgDiv.scrollIntoView({ behavior: 'smooth', block: 'end' });
}

function formatResponse(text) {
  return text
    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
    .replace(/^###?\s*(.+)$/gm, '<h3>$1</h3>')
    .replace(/^[-‚Ä¢]\s+(.+)$/gm, '<div class="section-block">$1</div>')
    .replace(/^\d+\.\s+(.+)$/gm, '<div class="section-block">$1</div>')
    .replace(/\n\n/g, '<br><br>')
    .replace(/\n/g, '<br>');
}

function showTyping() {
  const container = document.getElementById('chatContainer');
  const msgDiv = document.createElement('div');
  msgDiv.className = 'message ai';
  msgDiv.id = 'typingMsg';
  const avatar = document.createElement('div');
  avatar.className = 'avatar ai';
  avatar.textContent = 'üåø';
  const typing = document.createElement('div');
  typing.className = 'typing-indicator';
  typing.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
  msgDiv.appendChild(avatar);
  msgDiv.appendChild(typing);
  container.appendChild(msgDiv);
  msgDiv.scrollIntoView({ behavior: 'smooth', block: 'end' });
}

function removeTyping() {
  const t = document.getElementById('typingMsg');
  if (t) t.remove();
}

async function sendMessage() {
  const userText = input.value.trim();
  if (!userText || isLoading) return;

  isLoading = true;
  document.getElementById('sendBtn').disabled = true;
  input.value = '';
  input.style.height = 'auto';

  hideHero();
  createMessage('user', userText);
  showTyping();
  conversationHistory.push({ role: 'user', content: userText });

  try {
    const response = await fetch(WORKER_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-haiku-4-5-20251001',
        max_tokens: 1000,
        system: SYSTEM_PROMPT,
        messages: conversationHistory
      })
    });

    const data = await response.json();
    const aiText = data.content?.[0]?.text || 'Sorry, I could not process your request. Please try again.';
    conversationHistory.push({ role: 'assistant', content: aiText });
    removeTyping();
    createMessage('ai', aiText);
  } catch (err) {
    removeTyping();
    createMessage('ai', 'üåø Having trouble connecting. Please check your connection and try again.');
  }

  isLoading = false;
  document.getElementById('sendBtn').disabled = false;
  input.focus();
}
</script>
</body>
</html>
